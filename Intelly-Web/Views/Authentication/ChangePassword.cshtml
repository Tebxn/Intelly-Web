@model Intelly_Web.Entities.UserEnt

@{
    ViewData["Title"] = "ChangePassword";
}
<div class="wrapper-page w-75 h-75">

    <div class="card card-pages shadow-none">

        <div class="card-body">

            <div class="text-center m-t-0 m-b-15">
                <a href="index.html" class="logo logo-admin"><img src="~/images/logo-dark.png" alt="" height="70"></a>
            </div>
            <h5 class="font-18 text-center">Cambiar Contraseña</h5>

            <form asp-action="ChangePassword" asp-controller="Authentication" method="post" class="pt-3">

             
                <div class="container">

                    <input asp-for="User_Id" type="hidden" />
                    <div class="form-group">
                        <div class="col-md-6 mx-auto">
                            <label>Nueva Contraseña</label>
                            <input asp-for="User_Password" class="form-control form-control-lg" id="password" onkeyup="validPassword()" type="password" placeholder="Nueva contraseña" />
                        </div>
                        <div class="col-md-6 mx-auto">
                            <label> Confirmar contraseña</label>
                            <input class="form-control form-control-lg" id="passwordConfirm" type="password" onkeyup="validPassword()" placeholder="Confirmar nueva contraseña" />
                        </div>
                    </div>
                    <div class="col-md-12 mx-auto">
                        <div id="passwordError" class="text-danger"></div>
                    </div>
                    <div class="col-md-12 mx-auto">
                        <div id="passwordMessage" class="text-warning"></div>
                    </div>

                    <div class="form-group text-center m-t-20">
                        <div class="col-md-6 mx-auto">
                            <button class="btn btn-primary btn-block btn-lg waves-effect waves-light" id="btnConfirm" type="submit" disable>Cambiar contraseña</button>
                        </div>
                    </div>

                </div>
            </form>
            <div id="errorMessage" class="text-danger" style="display: none;">Las contraseñas no coinciden</div>
        </div>

    </div>
</div>

@*   <script>
    function validPassword() {
        var pass = document.getElementById("password").value;
        var passConfirm = document.getElementById("passwordConfirm").value;
        var btnConfirm = document.getElementById("btnConfirm");

        if (pass !== "" && pass === passConfirm) {
            btnConfirm.disabled = false; // Habilitar el botón
        } else {
            btnConfirm.disabled = true; // Deshabilitar el botón
        }
    }

    document.addEventListener("DOMContentLoaded", validPassword);
    

</script>  *@

<script>
    function validatePassword() {
        var pass = document.getElementById("password").value;
        var passConfirm = document.getElementById("passwordConfirm").value;
        var btnConfirm = document.getElementById("btnConfirm");
        var passwordField = document.getElementById("password");
        var passwordConfirmField = document.getElementById("passwordConfirm");
        var passwordError = document.getElementById("passwordError");
        var passwordMessage = document.getElementById("passwordMessage");

        // Verificar si se han ingresado datos en los campos de contraseña
        if (pass !== "" || passConfirm !== "") {
            // Verificar longitud mínima de 8 caracteres
            var hasMinLength = pass.length >= 8;
            // Verificar al menos una mayúscula
            var hasUpperCase = /[A-Z]/.test(pass);
            // Verificar al menos un número
            var hasNumber = /\d/.test(pass);

            if (hasMinLength && hasUpperCase && hasNumber) {
                passwordError.textContent = ""; // Limpiar mensaje de error
                if (pass === passConfirm) {
                    btnConfirm.disabled = false; // Habilitar el botón
                    passwordField.style.borderColor = "#28a745"; // Color verde para el borde
                    passwordConfirmField.style.borderColor = "#28a745"; // Color verde para el borde
                    passwordMessage.textContent = ""; // Limpiar mensaje de advertencia
                } else {
                    btnConfirm.disabled = true; // Deshabilitar el botón
                    passwordField.style.borderColor = "#dc3545"; // Color rojo para el borde
                    passwordConfirmField.style.borderColor = "#dc3545"; // Color rojo para el borde
                    passwordMessage.textContent = "Las contraseñas no coinciden."; // Mostrar mensaje de advertencia
                }
            } else {
                btnConfirm.disabled = true; // Deshabilitar el botón
                passwordField.style.borderColor = "#dc3545"; // Color rojo para el borde
                passwordConfirmField.style.borderColor = "#dc3545"; // Color rojo para el borde
                passwordError.textContent = "La contraseña debe tener al menos 8 caracteres, una mayúscula y un número."; // Mostrar mensaje de error
                passwordMessage.textContent = ""; // Limpiar mensaje de advertencia
            }
        } else {
            // Restaurar estilos predeterminados si no se han ingresado datos
            btnConfirm.disabled = true;
            passwordField.style.borderColor = "";
            passwordConfirmField.style.borderColor = "";
            passwordError.textContent = ""; // Limpiar mensaje de error
            passwordMessage.textContent = ""; // Limpiar mensaje de advertencia
        }
    }

    // Verificar al cargar la página y al ingresar datos
    document.addEventListener("DOMContentLoaded", function () {
        validatePassword();
        document.getElementById("password").addEventListener("input", validatePassword);
        document.getElementById("passwordConfirm").addEventListener("input", validatePassword);
    });
</script>







